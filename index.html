<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>100% Auto-Start + Permanent VM</title>
<style>
  body{margin:0;background:#000;color:#0f0;font-family:monospace;overflow:hidden}
  iframe{width:100vw;height:100vh;border:none}
  #info{position:fixed;top:10px;left:10px;z-index:999;background:rgba(0,0,0,0.9);padding:15px;border-radius:8px;font-size:15px}
</style>
</head>
<body>

<div id="info">
  Everything auto-starts every time<br>
  Apache • MariaDB • coturn • TinyFileManager • Full HTTPS<br>
  Close browser, reopen tomorrow → still running
</div>

<iframe src="https://bellard.org/jslinux/vm.html?url=alpine-x86-xwin.cfg&mem=512&graphic=1&persist=1&cmd=sh%20-c%20%27
# Only run full install once (first boot)
[ ! -f /etc/.firstboot-done ] && {
  apk update
  apk add apache2 php8 php8-apache2 php8-mysqli php8-mysqlnd mariadb mariadb-client openrc nano dillo geany newt whiptail coturn openssl ca-certificates curl wget git
  rc-update add apache2 default
  rc-update add mariadb default
  rc-update add coturn default
  /etc/init.d/mariadb setup
  mysql -u root -e "ALTER USER 'root'@'localhost' IDENTIFIED BY 'lamp123'; FLUSH PRIVILEGES;"
  wget -O /var/www/localhost/htdocs/tinyfilemanager.php https://raw.githubusercontent.com/prasathmani/tinyfilemanager/master/tinyfilemanager.php
  echo "<?php echo '<h1>Auto-Started LAMP + SSL Ready!</h1>'; phpinfo(); ?>" > /var/www/localhost/htdocs/index.php
  touch /etc/.firstboot-done
  echo "First-time setup complete – everything will auto-start forever"
}

# These lines run EVERY boot (because of persist=1)
sed -i "s/Listen 80/Listen 8000/" /etc/apache2/httpd.conf 2>/dev/null || true
/etc/init.d/mariadb start
/etc/init.d/apache2 restart
/etc/init.d/coturn start

echo "All services started! → http://localhost:8000"
echo "TinyFileManager → http://localhost:8000/tinyfilemanager.php (admin / admin@123)"
echo "HTTPS works in Dillo, curl, wget, git"

sleep infinity
%27"></iframe>

</body>
</html>
